

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The starry Python API &mdash; starry 1.0.0.dev1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="starry 1.0.0.dev1 documentation" href="index.html"/>
        <link rel="prev" title="Notes on limb darkening normalization" href="notebooks/LDNormalization.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> starry
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0.dev1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html"> Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html"> Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html"> Examples &amp; tutorials</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"> Python API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-map-class">The Map class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-dopplermap-class">The DopplerMap class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-starry.extensions">The extensions module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="html/index.html#://"> C++ API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rodluger/starry"> Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rodluger/starry/issues"> Submit an issue</a></li>
<li class="toctree-l1"><a class="reference external" href="http://adsabs.harvard.edu/abs/2019AJ....157...64L"> Read the paper</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">starry</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">starry</a> &raquo;</li>
      
    
      <li>The starry Python API</li>
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="the-starry-python-api">
<h1>The starry Python API<a class="headerlink" href="#the-starry-python-api" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#the-map-class" id="id3">The Map class</a></p></li>
<li><p><a class="reference internal" href="#the-dopplermap-class" id="id4">The DopplerMap class</a></p></li>
<li><p><a class="reference internal" href="#module-starry.extensions" id="id5">The extensions module</a></p></li>
</ul>
</div>
<div class="section" id="the-map-class">
<h2><a class="toc-backref" href="#id3">The Map class</a><a class="headerlink" href="#the-map-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="starry.Map">
<em class="property">class </em><code class="descclassname">starry.</code><code class="descname">Map</code><span class="sig-paren">(</span><em>*init_args</em>, <em>**init_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a <code class="xref py py-mod docutils literal notranslate"><span class="pre">starry</span></code> surface map. The map is described as an expansion in spherical harmonics, with optional arbitrary order limb darkening and an optional multiplicative spherical harmonic filter. Support for wavelength-dependent and time-dependent maps is included, as well as flux and intensity calculation in reflected light.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Map instances are normalized such that the <strong>average disk-integrated intensity is equal to unity</strong>. The total luminosity over all <span class="math notranslate nohighlight">\(4\pi\)</span> steradians is therefore <span class="math notranslate nohighlight">\(4\)</span>. This normalization is particularly convenient for constant or purely limb-darkened maps, whose disk-integrated intensity is always equal to unity.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ydeg</strong> (<em>int</em>) – Largest spherical harmonic degree of the surface map.</p></li>
<li><p><strong>udeg</strong> (<em>int</em>) – Largest limb darkening degree of the surface map. Default 0.</p></li>
<li><p><strong>fdeg</strong> (<em>int</em>) – Largest spherical harmonic filter degree. Default 0.</p></li>
<li><p><strong>nw</strong> (<em>int</em>) – Number of map wavelength bins. Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Number of map temporal bins. Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>reflected</strong> (<em>bool</em>) – If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>, performs all computations in         reflected light. Map coefficients represent albedos rather         than intensities. Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>multi</strong> (<em>bool</em>) – Use multi-precision to perform all         calculations? Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>,         defaults to 32-digit (approximately 128-bit) floating         point precision. This can be adjusted by changing the         <code class="xref py py-obj docutils literal notranslate"><span class="pre">STARRY_NMULTI</span></code> compiler macro.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="starry.Map.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intensity of the map at a point or on a grid of surface points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Time at which to evaluate. Default 0.                 <em>Temporal maps only.</em></p></li>
<li><p><strong>theta</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Angle of rotation. Default 0.</p></li>
<li><p><strong>x</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> position on the                 surface. Default 0.</p></li>
<li><p><strong>y</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <a class="reference internal" href="#starry.Map.y" title="starry.Map.y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code></a> position on the                 surface. Default 0.</p></li>
<li><p><strong>source</strong> (<em>ndarray</em>) – The source position, a unit vector or a
vector of unit vectors. Default <span class="math notranslate nohighlight">\(-\hat{x} = (-1, 0, 0)\)</span>.
<em>Reflected light maps only.</em></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A vector of intensities at the corresponding surface point(s).</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.__compile_flags__">
<code class="descname">__compile_flags__</code><a class="headerlink" href="#starry.Map.__compile_flags__" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of informational flags about the Map set at compile time.</p>
</dd></dl>

<dl class="method">
<dt id="starry.Map.__getitem__">
<code class="descname">__getitem__</code><span class="sig-paren">(</span><em>inds</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a spherical harmonic or limb darkening coefficient or
array of coefficients. Indexing is the same as in the <a class="reference internal" href="#starry.Map.__setitem__" title="starry.Map.__setitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__setitem__()</span></code></a>
method.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A spherical harmonic or limb darkening coefficient, or an array of coefficients.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="starry.Map.__setitem__">
<code class="descname">__setitem__</code><span class="sig-paren">(</span><em>inds</em>, <em>val</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.__setitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a spherical harmonic or limb darkening coefficient or
array of coefficients. Users may set these coefficients
multiple different ways. For example, for a scalar map:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>            <span class="c1"># Set the Y_{3,1} coefficient to a scalar</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">0.5</span>            <span class="c1"># Set all Y_{3,m} coefficients to 0.5</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>           <span class="c1"># Set all Y_{l,1} coefficients to 0.5</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>         <span class="c1"># Set all map coefficients</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>               <span class="c1"># Set the u_1 limb darkening coefficient</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>            <span class="c1"># Set all limb darkening coefficients</span>
</pre></div>
</div>
<p>For a spectral or temporal map, an extra index must be provided.
For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>         <span class="c1"># Set the Y_{3,1,0} coefficient to a scalar</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">0.5</span>         <span class="c1"># Set all Y_{3,1} coefficients to 0.5</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">0.5</span>        <span class="c1"># Set all Y_{l,1} coefficients to 0.5</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>      <span class="c1"># Set all map coefficients</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>            <span class="c1"># Set the u_{1,0} limb darkening coefficient</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>         <span class="c1"># Set all limb darkening coefficients</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.Map.add_spot">
<code class="descname">add_spot</code><span class="sig-paren">(</span><em>amp</em>, <em>sigma=0.1</em>, <em>lat=0.0</em>, <em>lon=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.add_spot" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the spherical harmonic expansion of a gaussian to the current
map. This routine adds a gaussian-like feature to the surface map
by computing the spherical harmonic expansion of a 3D gaussian
constrained to the surface of the sphere. This is useful for, say,
modeling star spots or other discrete, localized features on a
body’s surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amp</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The amplitude. Default 1.0, resulting in a gaussian whose integral over the sphere is unity. For spectral and temporal maps, this should be a vector corresponding to the amplitude in each map column.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – The standard deviation of the gaussian. Default 0.1</p></li>
<li><p><strong>lat</strong> (<em>float</em>) – The latitude of the center of the gaussian in degrees. Default 0.</p></li>
<li><p><strong>lon</strong> (<em>float</em>) – The longitude of the center of the gaussian in degrees. Default 0.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.Map.align">
<code class="descname">align</code><span class="sig-paren">(</span><em>source=None</em>, <em>dest=None</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.align" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the map to align the <code class="xref py py-obj docutils literal notranslate"><span class="pre">source</span></code> point/axis with the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">dest</span></code> point/axis.</p>
<p>The standard way of rotating maps in <code class="xref py py-obj docutils literal notranslate"><span class="pre">starry</span></code> is to
provide the axis and angle of rotation, but this isn’t always
convenient. In some cases, it is easier to specify a source
point/axis and a destination point/axis, and rotate the map such that the
source aligns with the destination. This is particularly useful for
changing map projections. For instance, to view the map pole-on,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="nb">map</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>This rotates the map axis to align with the z-axis, which points
toward the observer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>ndarray</em>) – A unit vector describing the source position.                 This point will be rotated onto <code class="xref py py-obj docutils literal notranslate"><span class="pre">dest</span></code>. Default                 is the current map axis.</p></li>
<li><p><strong>dest</strong> (<em>ndarray</em>) – A unit vector describing the destination position.                 The <code class="xref py py-obj docutils literal notranslate"><span class="pre">source</span></code> point will be rotated onto this point. Default                 is the current map axis.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.axis">
<code class="descname">axis</code><a class="headerlink" href="#starry.Map.axis" title="Permalink to this definition">¶</a></dt>
<dd><p>A <em>normalized</em> unit vector specifying the default axis of
rotation for the map. Default <span class="math notranslate nohighlight">\(\hat{y} = (0, 1, 0)\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Attribute not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.f">
<code class="descname">f</code><a class="headerlink" href="#starry.Map.f" title="Permalink to this definition">¶</a></dt>
<dd><p>The spherical harmonic filter coefficients.
This is a vector of the coefficients of the spherical harmonics
<span class="math notranslate nohighlight">\(\{Y_{0,0}, Y_{1,-1}, Y_{1,0}, Y_{1,1}, ...\}\)</span>. Whenever
intensities and fluxes are computed, the filter is applied
multiplicatively to the map. Filters are the extension of limb darkening
to non-radially symmetric modifications to the surface intensity.
<em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.fdeg">
<code class="descname">fdeg</code><a class="headerlink" href="#starry.Map.fdeg" title="Permalink to this definition">¶</a></dt>
<dd><p>The highest degree of the spherical harmonic filter. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.filter">
<code class="descname">filter</code><a class="headerlink" href="#starry.Map.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>The filter coefficients.</p>
<p>These are a vector of spherical harmonic coefficients that are
applied as a static multiplicative filter to the map whenever
intensities or fluxes or computed. This filter is the generalization
of limb darkening to non-radially symmetric fields. It can therefore
be used to model processes such as non-radial limb darkening,
gravity darkening, clouds, etc.</p>
<p>The filter coefficients can be accessed and set via the item
getter/setter operator <code class="xref py py-obj docutils literal notranslate"><span class="pre">[]</span></code>. For instance, the following
line</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="o">.</span><span class="n">filter</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
</pre></div>
</div>
<p>sets the <span class="math notranslate nohighlight">\(Y_{1, 0}\)</span> filter coefficient. Regardless of the orientation
of the map, it will always be weighted by this spherical harmonic
when computing intensities or fluxes. In this example, the effect is
the same as that of linear limb darkening.</p>
<p>See <a class="reference internal" href="#starry.Map.__setitem__" title="starry.Map.__setitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__setitem__()</span></code></a> and <a class="reference internal" href="#starry.Map.__getitem__" title="starry.Map.__getitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code></a> for details.</p>
</dd></dl>

<dl class="method">
<dt id="starry.Map.flux">
<code class="descname">flux</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the flux visible from the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Time at which to evaluate. Default 0.                 <em>Temporal maps only.</em></p></li>
<li><p><strong>theta</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Angle of rotation. Default 0.                 <em>Not available for pure limb darkening.</em></p></li>
<li><p><strong>xo</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> position of the                 occultor (if any). Default 0.                 <em>Not available for pure limb darkening.</em></p></li>
<li><p><strong>yo</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <a class="reference internal" href="#starry.Map.y" title="starry.Map.y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code></a> position of the                 occultor (if any). Default 0.                 <em>Not available for pure limb darkening.</em></p></li>
<li><p><strong>zo</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">z</span></code> position of the                 occultor (if any). Default 1.0 (on the side closest to                 the observer).</p></li>
<li><p><strong>b</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The impact parameter of the                 occultor. Default 0. <em>Purely limb-darkened maps only.</em></p></li>
<li><p><strong>ro</strong> (<em>float</em>) – The radius of the occultor in units of this                 body’s radius. Default 0 (no occultation).</p></li>
<li><p><strong>gradient</strong> (<em>bool</em>) – Compute and return the gradient of the                 flux as well? Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>source</strong> (<em>ndarray</em>) – The source position, a unit vector or a
vector of unit vectors. Default <span class="math notranslate nohighlight">\(-\hat{x} = (-1, 0, 0)\)</span>.
<em>Reflected light maps only.</em></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A vector of fluxes. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">gradient</span></code> is enabled, also returns a             dictionary whose keys are the derivatives of <cite>flux</cite> with respect             to all model parameters.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As noted above, the call sequence for this is different if             the map is purely limb-darkened (purely limb-darkened             maps are those with <code class="xref py py-obj docutils literal notranslate"><span class="pre">ydeg</span> <span class="pre">=</span> <span class="pre">0</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">fdeg</span> <span class="pre">=</span> <span class="pre">0</span></code>,             and <code class="xref py py-obj docutils literal notranslate"><span class="pre">udeg</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>). In this case, rather than providing the             <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> and <a class="reference internal" href="#starry.Map.y" title="starry.Map.y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code></a> positions of the occultor, the user             should only provide the impact paramter <code class="xref py py-obj docutils literal notranslate"><span class="pre">b</span></code> (since the             map is invariant to rotations about the line of sight).</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.Map.flux_op">
<code class="descname">flux_op</code><span class="sig-paren">(</span><em>y=None</em>, <em>u=None</em>, <em>inc=None</em>, <em>obl=None</em>, <em>theta=0</em>, <em>orbit=None</em>, <em>t=None</em>, <em>xo=None</em>, <em>yo=None</em>, <em>zo=1</em>, <em>ro=0.1</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.flux_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a
<a class="reference external" href="http://deeplearning.net/software/theano/extending/extending_theano.html">Theano Op</a>
for the flux computation.</p>
<p>This method is similar to <a class="reference internal" href="#starry.Map.flux" title="starry.Map.flux"><code class="xref py py-meth docutils literal notranslate"><span class="pre">flux()</span></code></a> but it does not return a
light curve! Instead, it returns a
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Theano</span></code> Op used for symbolic (lazy) gradient-based
computations useful for integration with <code class="xref py py-obj docutils literal notranslate"><span class="pre">exoplanet</span></code>
and <code class="xref py py-obj docutils literal notranslate"><span class="pre">pymc3</span></code>.</p>
<p>The arguments below can either be normal Python or <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code>
types, in which case they are assumed to be constant, or <code class="xref py py-obj docutils literal notranslate"><span class="pre">Theano</span></code>
tensor variables. They can also be set to <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code> (default), in
which case they take on the constant values set in the <a class="reference internal" href="#starry.Map" title="starry.Map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code></a>
object (or their default values, if they are not <a class="reference internal" href="#starry.Map" title="starry.Map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code></a>
attributes). As usual, the parameters <code class="xref py py-obj docutils literal notranslate"><span class="pre">theta</span></code>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">xo</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">yo</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">zo</span></code>, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">ro</span></code> may
be either scalars or vectors. Note that if an <code class="xref py py-obj docutils literal notranslate"><span class="pre">orbit</span></code> instance
is provided, <code class="xref py py-obj docutils literal notranslate"><span class="pre">xo</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">yo</span></code>, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">zo</span></code> are
ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> – The full vector of spherical harmonic coefficients,                 (skipping the <span class="math notranslate nohighlight">\(Y_{0,0}\)</span> term).</p></li>
<li><p><strong>u</strong> – The full vector of limb darkening coefficients,                  starting with <span class="math notranslate nohighlight">\(u_{1}\)</span>.</p></li>
<li><p><strong>inc</strong> – The map inclination in degrees.</p></li>
<li><p><strong>obl</strong> – The map obliquity in degrees.</p></li>
<li><p><strong>theta</strong> – The map rotation angle in degrees.</p></li>
<li><p><strong>orbit</strong> – An <code class="xref py py-obj docutils literal notranslate"><span class="pre">exoplanet</span></code> <code class="xref py py-obj docutils literal notranslate"><span class="pre">orbit</span></code> instance.</p></li>
<li><p><strong>t</strong> – The times at which to evaluate the <code class="xref py py-obj docutils literal notranslate"><span class="pre">orbit</span></code>.</p></li>
<li><p><strong>xo</strong> – The occultor x position.</p></li>
<li><p><strong>yo</strong> – The occultor y position.</p></li>
<li><p><strong>zo</strong> – The occultor z position.</p></li>
<li><p><strong>ro</strong> – The occultor radius.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-obj docutils literal notranslate"><span class="pre">Theano</span></code> Op defining the graph for the light curve computation.</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.inc">
<code class="descname">inc</code><a class="headerlink" href="#starry.Map.inc" title="Permalink to this definition">¶</a></dt>
<dd><p>The inclination of the map in degrees.
Setting this value overrides <a class="reference internal" href="#starry.Map.axis" title="starry.Map.axis"><code class="xref py py-attr docutils literal notranslate"><span class="pre">axis</span></code></a>. Default <span class="math notranslate nohighlight">\(90^\circ\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Attribute not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.Map.is_physical">
<code class="descname">is_physical</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.is_physical" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code> if the map intensity is non-negative
everywhere.</p>
<p>This routine uses <cite>scipy.optimize.minimize</cite> to attempt to find
the global minimum. Note that both the limb darkening and the
multiplicative filter are ignored.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This routine is not yet optimized and has not been             fully tested. It may be             unnecessarily slow and may not always find the global             minimum. This will be fixed in an upcoming version of the code.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.Map.linear_flux_model">
<code class="descname">linear_flux_model</code><span class="sig-paren">(</span><em>t=0.0, theta=0.0, xo=0.0, yo=0.0, zo=1.0, ro=0.0, source=[-1, 0, 0], gradient=False</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.linear_flux_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <cite>starry</cite> linear intensity model, the design matrix
used to compute the intensity on a grid of surface points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Time at which to evaluate. Default 0. <em>Temporal maps only.</em></p></li>
<li><p><strong>theta</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Angle of rotation. Default 0.</p></li>
<li><p><strong>x</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> position on the surface. Default 0.</p></li>
<li><p><strong>y</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <a class="reference internal" href="#starry.Map.y" title="starry.Map.y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code></a> position on the surface. Default 0.</p></li>
<li><p><strong>source</strong> (<em>ndarray</em>) – The source position, a unit vector or a
vector of unit vectors. Default <span class="math notranslate nohighlight">\(-\hat{x} = (-1, 0, 0)\)</span>.
<em>Reflected light maps only.</em></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A matrix <cite>X</cite>. When <cite>X</cite> is dotted into a spherical harmonic vector <cite>y</cite>, the result is the vector of intensities at the
corresponding surface points.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.Map.linear_intensity_model">
<code class="descname">linear_intensity_model</code><span class="sig-paren">(</span><em>t=0.0, theta=0.0, x=0.0, y=0.0, source=[-1, 0, 0]</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.linear_intensity_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <cite>starry</cite> linear intensity model, the design matrix
used to compute the intensity on a grid of surface points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Time at which to evaluate. Default 0. <em>Temporal maps only.</em></p></li>
<li><p><strong>theta</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Angle of rotation. Default 0.</p></li>
<li><p><strong>x</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> position on the surface. Default 0.</p></li>
<li><p><strong>y</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <a class="reference internal" href="#starry.Map.y" title="starry.Map.y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code></a> position on the surface. Default 0.</p></li>
<li><p><strong>source</strong> (<em>ndarray</em>) – The source position, a unit vector or a
vector of unit vectors. Default <span class="math notranslate nohighlight">\(-\hat{x} = (-1, 0, 0)\)</span>.
<em>Reflected light maps only.</em></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A matrix <cite>X</cite>. When <cite>X</cite> is dotted into a spherical harmonic vector <cite>y</cite>, the result is the vector of intensities at the
corresponding surface points.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.Map.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>image</em>, <em>ydeg=None</em>, <em>healpix=False</em>, <em>col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an image, array, or <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span></code> map.</p>
<p>This routine uses
various routines in <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span></code> to compute the spherical
harmonic expansion of the input image and sets the map’s <a class="reference internal" href="#starry.Map.y" title="starry.Map.y"><code class="xref py py-attr docutils literal notranslate"><span class="pre">y</span></code></a>
coefficients accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> – A path to an image file, a two-dimensional <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code>                 array, or a <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span></code> map array                 (if <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span> <span class="pre">=</span> <span class="pre">True</span></code>).</p></li>
<li><p><strong>ydeg</strong> (<em>int</em>) – The degree of the spherical harmonic expansion of the                 image. Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, in which case the expansion is                 performed up to <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.ydeg</span></code>.</p></li>
<li><p><strong>healpix</strong> (<em>bool</em>) – Treat <code class="xref py py-obj docutils literal notranslate"><span class="pre">image</span></code> as a <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span></code> array?                 Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>col</strong> – The map column into which the image will be loaded. Can be                 an <code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">slice</span></code>, or <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>.                 Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, in which case the image is loaded into                 the first map column. This option is ignored for scalar maps.</p></li>
<li><p><strong>sampling_factor</strong> (<em>int</em>) – Oversampling factor when computing the                 <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span></code> representation of an input image or array.                 Default 8. Increasing this number may improve the fidelity of                 the expanded map, but the calculation will take longer.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – If not <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, apply gaussian smoothing                 with standard deviation <code class="xref py py-obj docutils literal notranslate"><span class="pre">sigma</span></code> to smooth over                 spurious ringing features. Smoothing is performed with                 the <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix.sphtfunc.smoothalm</span></code> method.                 Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.Map.max">
<code class="descname">max</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.max" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the global maximum of the intensity.</p>
<p>This routine uses <cite>scipy.optimize.minimize</cite> to attempt to find
the global maximum. Note that both the limb darkening and the
multiplicative filter are disabled for this method.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This routine is not yet optimized and has not been             fully tested. It may be             unnecessarily slow and may not always find the global             maximum. This will be fixed in an upcoming version of the code.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.Map.min">
<code class="descname">min</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.min" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the global minimum of the intensity.</p>
<p>This routine uses <cite>scipy.optimize.minimize</cite> to attempt to find
the global minimum. Note that both the limb darkening and the
multiplicative filter are disabled for this method.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This routine is not yet optimized and has not been             fully tested. It may be             unnecessarily slow and may not always find the global             minimum. This will be fixed in an upcoming version of the code.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.multi">
<code class="descname">multi</code><a class="headerlink" href="#starry.Map.multi" title="Permalink to this definition">¶</a></dt>
<dd><p>Are calculations done using multi-precision? <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.N">
<code class="descname">N</code><a class="headerlink" href="#starry.Map.N" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of map coefficients after applying the filters
(if applicable). <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.Nf">
<code class="descname">Nf</code><a class="headerlink" href="#starry.Map.Nf" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of spherical harmonic filter coefficients, including
the <span class="math notranslate nohighlight">\(Y_{0,0}\)</span> term. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.nt">
<code class="descname">nt</code><a class="headerlink" href="#starry.Map.nt" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of temporal bins. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.Nu">
<code class="descname">Nu</code><a class="headerlink" href="#starry.Map.Nu" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of limb darkening coefficients, including
the <span class="math notranslate nohighlight">\(u_{0}\)</span> term. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.nw">
<code class="descname">nw</code><a class="headerlink" href="#starry.Map.nw" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of wavelength bins. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.Ny">
<code class="descname">Ny</code><a class="headerlink" href="#starry.Map.Ny" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of spherical harmonic coefficients, including
the <span class="math notranslate nohighlight">\(Y_{0,0}\)</span> term. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.obl">
<code class="descname">obl</code><a class="headerlink" href="#starry.Map.obl" title="Permalink to this definition">¶</a></dt>
<dd><p>The obliquity of the map in degrees.
Setting this value overrides <a class="reference internal" href="#starry.Map.axis" title="starry.Map.axis"><code class="xref py py-attr docutils literal notranslate"><span class="pre">axis</span></code></a>. Default <span class="math notranslate nohighlight">\(0^\circ\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Attribute not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.Map.random">
<code class="descname">random</code><span class="sig-paren">(</span><em>power</em>, <em>seed=None</em>, <em>col=None</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a map from an isotropic distribution with a given power
spectrum in <span class="math notranslate nohighlight">\(l\)</span> and set the map coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>power</strong> (<em>ndarray</em>) – The power at each degree, starting at <code class="code docutils literal notranslate"><span class="pre">l=0</span></code>.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Randomizer seed. Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>col</strong> (<em>int</em>) – The map column into which the random map will be placed.Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code> (in which case the map is replicated into all columns). <em>Spectral / temporal maps only.</em></p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.Map.render">
<code class="descname">render</code><span class="sig-paren">(</span><em>theta=0</em>, <em>res=300</em>, <em>projection='ortho'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the map on a grid and return the pixel intensities as a
two-dimensional array (with time as an optional third dimension).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>float</em>) – Angle of rotation of the map in degrees. Default 0.</p></li>
<li><p><strong>res</strong> (<em>int</em>) – Map resolution, corresponding to the number of pixels                 on a side (for the orthographic projection) or the number of                 pixels in latitude (for the rectangular projection; the number                 of pixels in longitude is twice this value). Default 300.</p></li>
<li><p><strong>projection</strong> (<em>str</em>) – One of “orthographic” or “rectangular”. The former                 results in a map of the disk as seen on the plane of the sky,                 padded by <code class="xref py py-obj docutils literal notranslate"><span class="pre">NaN</span></code> outside of the disk. The latter results                 in an equirectangular (geographic, equidistant cylindrical)                 view of the entire surface of the map in latitude-longitude space.                 Default “orthographic”.</p></li>
<li><p><strong>t</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The time(s) at which to evaluate the map.                 <em>Temporal maps only</em>. Default 0.</p></li>
<li><p><strong>source</strong> (<em>ndarray</em>) – A unit vector corresponding to the direction to the                 light source. This may optionally be a vector of unit vectors.                 <em>Reflected light maps only</em>. Default <span class="math notranslate nohighlight">\(-\hat{x}\)</span>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="starry.Map.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all of the spherical harmonic, limb darkening, and filter
coefficients. Also reset the rotation axis.</p>
</dd></dl>

<dl class="method">
<dt id="starry.Map.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>theta=0</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the base map an angle <code class="xref py py-obj docutils literal notranslate"><span class="pre">theta</span></code> about <a class="reference internal" href="#starry.Map.axis" title="starry.Map.axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">axis</span></code></a>.
This performs a permanent rotation to the base map. Subsequent
rotations and calculations will be performed relative to this
rotational state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>float</em>) – Angle of rotation in degrees. Default 0.</p></li>
<li><p><strong>axis</strong> (<em>ndarray</em>) – Axis of rotation. Default is the current map axis.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.Map.show">
<code class="descname">show</code><span class="sig-paren">(</span><em>Z=None</em>, <em>cmap='plasma'</em>, <em>projection='ortho'</em>, <em>grid=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.Map.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Render and plot an image of the map; optionally display an animation.</p>
<p>If running in a Jupyter Notebook, animations will be displayed
in the notebook using javascript.
Refer to the docstring of <a class="reference internal" href="#starry.Map.render" title="starry.Map.render"><code class="xref py py-meth docutils literal notranslate"><span class="pre">render()</span></code></a> for additional kwargs
accepted by this method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Z</strong> (<em>ndarray</em>) – The array of pixel intensities returned by a call                 to <a class="reference internal" href="#starry.Map.render" title="starry.Map.render"><code class="xref py py-meth docutils literal notranslate"><span class="pre">render()</span></code></a>. Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, in which case                 this routine will call <a class="reference internal" href="#starry.Map.render" title="starry.Map.render"><code class="xref py py-meth docutils literal notranslate"><span class="pre">render()</span></code></a> with any additional                 kwargs provided by the user.</p></li>
<li><p><strong>cmap</strong> – The colormap used for plotting (a string or a                 <code class="xref py py-obj docutils literal notranslate"><span class="pre">matplotlib</span></code> colormap object). Default “plasma”.</p></li>
<li><p><strong>grid</strong> (<em>bool</em>) – Overplot static grid lines? Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Interval in ms between frames (animated maps only).                 Default 75.</p></li>
<li><p><strong>mp4</strong> (<em>str</em>) – Name of the mp4 file to save the animation to                 (animated maps only). Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>kwargs</strong> – Any additional kwargs accepted by <a class="reference internal" href="#starry.Map.render" title="starry.Map.render"><code class="xref py py-meth docutils literal notranslate"><span class="pre">render()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.u">
<code class="descname">u</code><a class="headerlink" href="#starry.Map.u" title="Permalink to this definition">¶</a></dt>
<dd><p>The limb darkening map coefficients. For scalar maps,
this is a vector of the limb darkening coefficients
<span class="math notranslate nohighlight">\(\{u_1, u_2, u_3, ...\}\)</span>. For spectral maps, this is a <em>matrix</em>,
where each column is the limb darkening vector at a particular
wavelength. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.udeg">
<code class="descname">udeg</code><a class="headerlink" href="#starry.Map.udeg" title="Permalink to this definition">¶</a></dt>
<dd><p>The highest degree of the limb darkening filter. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.y">
<code class="descname">y</code><a class="headerlink" href="#starry.Map.y" title="Permalink to this definition">¶</a></dt>
<dd><p>The spherical harmonic map coefficients. For scalar maps,
this is a vector of the coefficients of the spherical harmonics
<span class="math notranslate nohighlight">\(\{Y_{0,0}, Y_{1,-1}, Y_{1,0}, Y_{1,1}, ...\}\)</span>.
For spectral maps, this is a <em>matrix</em>, where each column
is the spherical harmonic vector at a particular wavelength.
For temporal maps, this is also a <em>flattened</em> matrix, where the
vectors corresponding to each temporal component are stacked
on top of each other. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.Map.ydeg">
<code class="descname">ydeg</code><a class="headerlink" href="#starry.Map.ydeg" title="Permalink to this definition">¶</a></dt>
<dd><p>The highest spherical harmonic degree of the map. <em>Read-only.</em></p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-dopplermap-class">
<h2><a class="toc-backref" href="#id4">The DopplerMap class</a><a class="headerlink" href="#the-dopplermap-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="starry.DopplerMap">
<em class="property">class </em><code class="descclassname">starry.</code><code class="descname">DopplerMap</code><span class="sig-paren">(</span><em>*init_args</em>, <em>**init_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a <code class="xref py py-mod docutils literal notranslate"><span class="pre">starry</span></code> Doppler map. This map behaves the same as a regular <a class="reference internal" href="#starry.Map" title="starry.Map"><code class="xref py py-mod docutils literal notranslate"><span class="pre">starry.Map</span></code></a> instance, except it implements the custom <a class="reference internal" href="#starry.DopplerMap.rv" title="starry.DopplerMap.rv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rv()</span></code></a> and <a class="reference internal" href="#starry.DopplerMap.rv_op" title="starry.DopplerMap.rv_op"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rv_op()</span></code></a> methods for computing the net radial velocity imparted by occultations or the darkening due to surface features such as spots. It also implements new attributes, including <a class="reference internal" href="#starry.DopplerMap.alpha" title="starry.DopplerMap.alpha"><code class="xref py py-attr docutils literal notranslate"><span class="pre">alpha()</span></code></a> and <a class="reference internal" href="#starry.DopplerMap.veq" title="starry.DopplerMap.veq"><code class="xref py py-meth docutils literal notranslate"><span class="pre">veq()</span></code></a> for specifying additional map properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ydeg</strong> (<em>int</em>) – Largest spherical harmonic degree of the surface map.</p></li>
<li><p><strong>udeg</strong> (<em>int</em>) – Largest limb darkening degree of the surface map. Default 0.</p></li>
<li><p><strong>fdeg</strong> (<em>int</em>) – Largest spherical harmonic filter degree. Default 0.</p></li>
<li><p><strong>nw</strong> (<em>int</em>) – Number of map wavelength bins. Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Number of map temporal bins. Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>multi</strong> (<em>bool</em>) – Use multi-precision to perform all         calculations? Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>,         defaults to 32-digit (approximately 128-bit) floating         point precision. This can be adjusted by changing the         <code class="xref py py-obj docutils literal notranslate"><span class="pre">STARRY_NMULTI</span></code> compiler macro.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="starry.DopplerMap.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intensity of the map at a point or on a grid of surface points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Time at which to evaluate. Default 0.                 <em>Temporal maps only.</em></p></li>
<li><p><strong>theta</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Angle of rotation. Default 0.</p></li>
<li><p><strong>x</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> position on the                 surface. Default 0.</p></li>
<li><p><strong>y</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <a class="reference internal" href="#starry.DopplerMap.y" title="starry.DopplerMap.y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code></a> position on the                 surface. Default 0.</p></li>
<li><p><strong>source</strong> (<em>ndarray</em>) – The source position, a unit vector or a
vector of unit vectors. Default <span class="math notranslate nohighlight">\(-\hat{x} = (-1, 0, 0)\)</span>.
<em>Reflected light maps only.</em></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A vector of intensities at the corresponding surface point(s).</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.__compile_flags__">
<code class="descname">__compile_flags__</code><a class="headerlink" href="#starry.DopplerMap.__compile_flags__" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of informational flags about the Map set at compile time.</p>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.__getitem__">
<code class="descname">__getitem__</code><span class="sig-paren">(</span><em>inds</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a spherical harmonic or limb darkening coefficient or
array of coefficients. Indexing is the same as in the <a class="reference internal" href="#starry.DopplerMap.__setitem__" title="starry.DopplerMap.__setitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__setitem__()</span></code></a>
method.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A spherical harmonic or limb darkening coefficient, or an array of coefficients.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.__setitem__">
<code class="descname">__setitem__</code><span class="sig-paren">(</span><em>inds</em>, <em>val</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.__setitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a spherical harmonic or limb darkening coefficient or
array of coefficients. Users may set these coefficients
multiple different ways. For example, for a scalar map:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>            <span class="c1"># Set the Y_{3,1} coefficient to a scalar</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">0.5</span>            <span class="c1"># Set all Y_{3,m} coefficients to 0.5</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>           <span class="c1"># Set all Y_{l,1} coefficients to 0.5</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>         <span class="c1"># Set all map coefficients</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>               <span class="c1"># Set the u_1 limb darkening coefficient</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>            <span class="c1"># Set all limb darkening coefficients</span>
</pre></div>
</div>
<p>For a spectral or temporal map, an extra index must be provided.
For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>         <span class="c1"># Set the Y_{3,1,0} coefficient to a scalar</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">0.5</span>         <span class="c1"># Set all Y_{3,1} coefficients to 0.5</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">0.5</span>        <span class="c1"># Set all Y_{l,1} coefficients to 0.5</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>      <span class="c1"># Set all map coefficients</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>            <span class="c1"># Set the u_{1,0} limb darkening coefficient</span>
<span class="nb">map</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>         <span class="c1"># Set all limb darkening coefficients</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.add_spot">
<code class="descname">add_spot</code><span class="sig-paren">(</span><em>amp</em>, <em>sigma=0.1</em>, <em>lat=0.0</em>, <em>lon=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.add_spot" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the spherical harmonic expansion of a gaussian to the current
map. This routine adds a gaussian-like feature to the surface map
by computing the spherical harmonic expansion of a 3D gaussian
constrained to the surface of the sphere. This is useful for, say,
modeling star spots or other discrete, localized features on a
body’s surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amp</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The amplitude. Default 1.0, resulting in a gaussian whose integral over the sphere is unity. For spectral and temporal maps, this should be a vector corresponding to the amplitude in each map column.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – The standard deviation of the gaussian. Default 0.1</p></li>
<li><p><strong>lat</strong> (<em>float</em>) – The latitude of the center of the gaussian in degrees. Default 0.</p></li>
<li><p><strong>lon</strong> (<em>float</em>) – The longitude of the center of the gaussian in degrees. Default 0.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.align">
<code class="descname">align</code><span class="sig-paren">(</span><em>source=None</em>, <em>dest=None</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.align" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the map to align the <code class="xref py py-obj docutils literal notranslate"><span class="pre">source</span></code> point/axis with the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">dest</span></code> point/axis.</p>
<p>The standard way of rotating maps in <code class="xref py py-obj docutils literal notranslate"><span class="pre">starry</span></code> is to
provide the axis and angle of rotation, but this isn’t always
convenient. In some cases, it is easier to specify a source
point/axis and a destination point/axis, and rotate the map such that the
source aligns with the destination. This is particularly useful for
changing map projections. For instance, to view the map pole-on,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="nb">map</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>This rotates the map axis to align with the z-axis, which points
toward the observer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>ndarray</em>) – A unit vector describing the source position.                 This point will be rotated onto <code class="xref py py-obj docutils literal notranslate"><span class="pre">dest</span></code>. Default                 is the current map axis.</p></li>
<li><p><strong>dest</strong> (<em>ndarray</em>) – A unit vector describing the destination position.                 The <code class="xref py py-obj docutils literal notranslate"><span class="pre">source</span></code> point will be rotated onto this point. Default                 is the current map axis.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.alpha">
<code class="descname">alpha</code><a class="headerlink" href="#starry.DopplerMap.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>The rotational shear coefficient, a float in the range [0, 1].</p>
<p>The parameter <span class="math notranslate nohighlight">\(\alpha\)</span> is used to model linear differential
rotation. The angular velocity at a given latitude <span class="math notranslate nohighlight">\(\theta\)</span>
is</p>
<p><span class="math notranslate nohighlight">\(\omega = \omega_{eq}(1 - \alpha \sin^2\theta)\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\omega_{eq}\)</span> is the equatorial angular velocity.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.axis">
<code class="descname">axis</code><a class="headerlink" href="#starry.DopplerMap.axis" title="Permalink to this definition">¶</a></dt>
<dd><p>A <em>normalized</em> unit vector specifying the default axis of
rotation for the map. Default <span class="math notranslate nohighlight">\(\hat{y} = (0, 1, 0)\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Attribute not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.f">
<code class="descname">f</code><a class="headerlink" href="#starry.DopplerMap.f" title="Permalink to this definition">¶</a></dt>
<dd><p>The spherical harmonic filter coefficients.
This is a vector of the coefficients of the spherical harmonics
<span class="math notranslate nohighlight">\(\{Y_{0,0}, Y_{1,-1}, Y_{1,0}, Y_{1,1}, ...\}\)</span>. Whenever
intensities and fluxes are computed, the filter is applied
multiplicatively to the map. Filters are the extension of limb darkening
to non-radially symmetric modifications to the surface intensity.
<em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.fdeg">
<code class="descname">fdeg</code><a class="headerlink" href="#starry.DopplerMap.fdeg" title="Permalink to this definition">¶</a></dt>
<dd><p>The highest degree of the spherical harmonic filter. <em>Read-only.</em></p>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.flux">
<code class="descname">flux</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the flux visible from the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Time at which to evaluate. Default 0.                 <em>Temporal maps only.</em></p></li>
<li><p><strong>theta</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Angle of rotation. Default 0.                 <em>Not available for pure limb darkening.</em></p></li>
<li><p><strong>xo</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> position of the                 occultor (if any). Default 0.                 <em>Not available for pure limb darkening.</em></p></li>
<li><p><strong>yo</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <a class="reference internal" href="#starry.DopplerMap.y" title="starry.DopplerMap.y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code></a> position of the                 occultor (if any). Default 0.                 <em>Not available for pure limb darkening.</em></p></li>
<li><p><strong>zo</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">z</span></code> position of the                 occultor (if any). Default 1.0 (on the side closest to                 the observer).</p></li>
<li><p><strong>b</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The impact parameter of the                 occultor. Default 0. <em>Purely limb-darkened maps only.</em></p></li>
<li><p><strong>ro</strong> (<em>float</em>) – The radius of the occultor in units of this                 body’s radius. Default 0 (no occultation).</p></li>
<li><p><strong>gradient</strong> (<em>bool</em>) – Compute and return the gradient of the                 flux as well? Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>source</strong> (<em>ndarray</em>) – The source position, a unit vector or a
vector of unit vectors. Default <span class="math notranslate nohighlight">\(-\hat{x} = (-1, 0, 0)\)</span>.
<em>Reflected light maps only.</em></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A vector of fluxes. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">gradient</span></code> is enabled, also returns a             dictionary whose keys are the derivatives of <cite>flux</cite> with respect             to all model parameters.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As noted above, the call sequence for this is different if             the map is purely limb-darkened (purely limb-darkened             maps are those with <code class="xref py py-obj docutils literal notranslate"><span class="pre">ydeg</span> <span class="pre">=</span> <span class="pre">0</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">fdeg</span> <span class="pre">=</span> <span class="pre">0</span></code>,             and <code class="xref py py-obj docutils literal notranslate"><span class="pre">udeg</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>). In this case, rather than providing the             <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> and <a class="reference internal" href="#starry.DopplerMap.y" title="starry.DopplerMap.y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code></a> positions of the occultor, the user             should only provide the impact paramter <code class="xref py py-obj docutils literal notranslate"><span class="pre">b</span></code> (since the             map is invariant to rotations about the line of sight).</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.flux_op">
<code class="descname">flux_op</code><span class="sig-paren">(</span><em>y=None</em>, <em>u=None</em>, <em>inc=None</em>, <em>obl=None</em>, <em>theta=0</em>, <em>orbit=None</em>, <em>t=None</em>, <em>xo=None</em>, <em>yo=None</em>, <em>zo=1</em>, <em>ro=0.1</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.flux_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a
<a class="reference external" href="http://deeplearning.net/software/theano/extending/extending_theano.html">Theano Op</a>
for the flux computation.</p>
<p>This method is similar to <a class="reference internal" href="#starry.DopplerMap.flux" title="starry.DopplerMap.flux"><code class="xref py py-meth docutils literal notranslate"><span class="pre">flux()</span></code></a> but it does not return a
light curve! Instead, it returns a
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Theano</span></code> Op used for symbolic (lazy) gradient-based
computations useful for integration with <code class="xref py py-obj docutils literal notranslate"><span class="pre">exoplanet</span></code>
and <code class="xref py py-obj docutils literal notranslate"><span class="pre">pymc3</span></code>.</p>
<p>The arguments below can either be normal Python or <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code>
types, in which case they are assumed to be constant, or <code class="xref py py-obj docutils literal notranslate"><span class="pre">Theano</span></code>
tensor variables. They can also be set to <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code> (default), in
which case they take on the constant values set in the <a class="reference internal" href="#starry.Map" title="starry.Map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code></a>
object (or their default values, if they are not <a class="reference internal" href="#starry.Map" title="starry.Map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code></a>
attributes). As usual, the parameters <code class="xref py py-obj docutils literal notranslate"><span class="pre">theta</span></code>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">xo</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">yo</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">zo</span></code>, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">ro</span></code> may
be either scalars or vectors. Note that if an <code class="xref py py-obj docutils literal notranslate"><span class="pre">orbit</span></code> instance
is provided, <code class="xref py py-obj docutils literal notranslate"><span class="pre">xo</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">yo</span></code>, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">zo</span></code> are
ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> – The full vector of spherical harmonic coefficients,                 (skipping the <span class="math notranslate nohighlight">\(Y_{0,0}\)</span> term).</p></li>
<li><p><strong>u</strong> – The full vector of limb darkening coefficients,                  starting with <span class="math notranslate nohighlight">\(u_{1}\)</span>.</p></li>
<li><p><strong>inc</strong> – The map inclination in degrees.</p></li>
<li><p><strong>obl</strong> – The map obliquity in degrees.</p></li>
<li><p><strong>theta</strong> – The map rotation angle in degrees.</p></li>
<li><p><strong>orbit</strong> – An <code class="xref py py-obj docutils literal notranslate"><span class="pre">exoplanet</span></code> <code class="xref py py-obj docutils literal notranslate"><span class="pre">orbit</span></code> instance.</p></li>
<li><p><strong>t</strong> – The times at which to evaluate the <code class="xref py py-obj docutils literal notranslate"><span class="pre">orbit</span></code>.</p></li>
<li><p><strong>xo</strong> – The occultor x position.</p></li>
<li><p><strong>yo</strong> – The occultor y position.</p></li>
<li><p><strong>zo</strong> – The occultor z position.</p></li>
<li><p><strong>ro</strong> – The occultor radius.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-obj docutils literal notranslate"><span class="pre">Theano</span></code> Op defining the graph for the light curve computation.</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.inc">
<code class="descname">inc</code><a class="headerlink" href="#starry.DopplerMap.inc" title="Permalink to this definition">¶</a></dt>
<dd><p>The inclination of the map in degrees.
Setting this value overrides <a class="reference internal" href="#starry.DopplerMap.axis" title="starry.DopplerMap.axis"><code class="xref py py-attr docutils literal notranslate"><span class="pre">axis</span></code></a>. Default <span class="math notranslate nohighlight">\(90^\circ\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Attribute not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.is_physical">
<code class="descname">is_physical</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.is_physical" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code> if the map intensity is non-negative
everywhere.</p>
<p>This routine uses <cite>scipy.optimize.minimize</cite> to attempt to find
the global minimum. Note that both the limb darkening and the
multiplicative filter are ignored.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This routine is not yet optimized and has not been             fully tested. It may be             unnecessarily slow and may not always find the global             minimum. This will be fixed in an upcoming version of the code.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.linear_flux_model">
<code class="descname">linear_flux_model</code><span class="sig-paren">(</span><em>t=0.0, theta=0.0, xo=0.0, yo=0.0, zo=1.0, ro=0.0, source=[-1, 0, 0], gradient=False</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.linear_flux_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <cite>starry</cite> linear intensity model, the design matrix
used to compute the intensity on a grid of surface points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Time at which to evaluate. Default 0. <em>Temporal maps only.</em></p></li>
<li><p><strong>theta</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Angle of rotation. Default 0.</p></li>
<li><p><strong>x</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> position on the surface. Default 0.</p></li>
<li><p><strong>y</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <a class="reference internal" href="#starry.DopplerMap.y" title="starry.DopplerMap.y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code></a> position on the surface. Default 0.</p></li>
<li><p><strong>source</strong> (<em>ndarray</em>) – The source position, a unit vector or a
vector of unit vectors. Default <span class="math notranslate nohighlight">\(-\hat{x} = (-1, 0, 0)\)</span>.
<em>Reflected light maps only.</em></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A matrix <cite>X</cite>. When <cite>X</cite> is dotted into a spherical harmonic vector <cite>y</cite>, the result is the vector of intensities at the
corresponding surface points.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.linear_intensity_model">
<code class="descname">linear_intensity_model</code><span class="sig-paren">(</span><em>t=0.0, theta=0.0, x=0.0, y=0.0, source=[-1, 0, 0]</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.linear_intensity_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <cite>starry</cite> linear intensity model, the design matrix
used to compute the intensity on a grid of surface points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Time at which to evaluate. Default 0. <em>Temporal maps only.</em></p></li>
<li><p><strong>theta</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Angle of rotation. Default 0.</p></li>
<li><p><strong>x</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> position on the surface. Default 0.</p></li>
<li><p><strong>y</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <a class="reference internal" href="#starry.DopplerMap.y" title="starry.DopplerMap.y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code></a> position on the surface. Default 0.</p></li>
<li><p><strong>source</strong> (<em>ndarray</em>) – The source position, a unit vector or a
vector of unit vectors. Default <span class="math notranslate nohighlight">\(-\hat{x} = (-1, 0, 0)\)</span>.
<em>Reflected light maps only.</em></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A matrix <cite>X</cite>. When <cite>X</cite> is dotted into a spherical harmonic vector <cite>y</cite>, the result is the vector of intensities at the
corresponding surface points.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>image</em>, <em>ydeg=None</em>, <em>healpix=False</em>, <em>col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an image, array, or <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span></code> map.</p>
<p>This routine uses
various routines in <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span></code> to compute the spherical
harmonic expansion of the input image and sets the map’s <a class="reference internal" href="#starry.DopplerMap.y" title="starry.DopplerMap.y"><code class="xref py py-attr docutils literal notranslate"><span class="pre">y</span></code></a>
coefficients accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> – A path to an image file, a two-dimensional <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code>                 array, or a <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span></code> map array                 (if <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span> <span class="pre">=</span> <span class="pre">True</span></code>).</p></li>
<li><p><strong>ydeg</strong> (<em>int</em>) – The degree of the spherical harmonic expansion of the                 image. Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, in which case the expansion is                 performed up to <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.ydeg</span></code>.</p></li>
<li><p><strong>healpix</strong> (<em>bool</em>) – Treat <code class="xref py py-obj docutils literal notranslate"><span class="pre">image</span></code> as a <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span></code> array?                 Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>col</strong> – The map column into which the image will be loaded. Can be                 an <code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">slice</span></code>, or <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>.                 Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, in which case the image is loaded into                 the first map column. This option is ignored for scalar maps.</p></li>
<li><p><strong>sampling_factor</strong> (<em>int</em>) – Oversampling factor when computing the                 <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span></code> representation of an input image or array.                 Default 8. Increasing this number may improve the fidelity of                 the expanded map, but the calculation will take longer.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – If not <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, apply gaussian smoothing                 with standard deviation <code class="xref py py-obj docutils literal notranslate"><span class="pre">sigma</span></code> to smooth over                 spurious ringing features. Smoothing is performed with                 the <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix.sphtfunc.smoothalm</span></code> method.                 Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.max">
<code class="descname">max</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.max" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the global maximum of the intensity.</p>
<p>This routine uses <cite>scipy.optimize.minimize</cite> to attempt to find
the global maximum. Note that both the limb darkening and the
multiplicative filter are disabled for this method.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This routine is not yet optimized and has not been             fully tested. It may be             unnecessarily slow and may not always find the global             maximum. This will be fixed in an upcoming version of the code.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.min">
<code class="descname">min</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.min" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the global minimum of the intensity.</p>
<p>This routine uses <cite>scipy.optimize.minimize</cite> to attempt to find
the global minimum. Note that both the limb darkening and the
multiplicative filter are disabled for this method.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This routine is not yet optimized and has not been             fully tested. It may be             unnecessarily slow and may not always find the global             minimum. This will be fixed in an upcoming version of the code.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.multi">
<code class="descname">multi</code><a class="headerlink" href="#starry.DopplerMap.multi" title="Permalink to this definition">¶</a></dt>
<dd><p>Are calculations done using multi-precision? <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.N">
<code class="descname">N</code><a class="headerlink" href="#starry.DopplerMap.N" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of map coefficients after applying the filters
(if applicable). <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.Nf">
<code class="descname">Nf</code><a class="headerlink" href="#starry.DopplerMap.Nf" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of spherical harmonic filter coefficients, including
the <span class="math notranslate nohighlight">\(Y_{0,0}\)</span> term. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.nt">
<code class="descname">nt</code><a class="headerlink" href="#starry.DopplerMap.nt" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of temporal bins. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.Nu">
<code class="descname">Nu</code><a class="headerlink" href="#starry.DopplerMap.Nu" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of limb darkening coefficients, including
the <span class="math notranslate nohighlight">\(u_{0}\)</span> term. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.nw">
<code class="descname">nw</code><a class="headerlink" href="#starry.DopplerMap.nw" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of wavelength bins. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.Ny">
<code class="descname">Ny</code><a class="headerlink" href="#starry.DopplerMap.Ny" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of spherical harmonic coefficients, including
the <span class="math notranslate nohighlight">\(Y_{0,0}\)</span> term. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.obl">
<code class="descname">obl</code><a class="headerlink" href="#starry.DopplerMap.obl" title="Permalink to this definition">¶</a></dt>
<dd><p>The obliquity of the map in degrees.
Setting this value overrides <a class="reference internal" href="#starry.DopplerMap.axis" title="starry.DopplerMap.axis"><code class="xref py py-attr docutils literal notranslate"><span class="pre">axis</span></code></a>. Default <span class="math notranslate nohighlight">\(0^\circ\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Attribute not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.random">
<code class="descname">random</code><span class="sig-paren">(</span><em>power</em>, <em>seed=None</em>, <em>col=None</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a map from an isotropic distribution with a given power
spectrum in <span class="math notranslate nohighlight">\(l\)</span> and set the map coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>power</strong> (<em>ndarray</em>) – The power at each degree, starting at <code class="code docutils literal notranslate"><span class="pre">l=0</span></code>.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Randomizer seed. Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>col</strong> (<em>int</em>) – The map column into which the random map will be placed.Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code> (in which case the map is replicated into all columns). <em>Spectral / temporal maps only.</em></p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.render">
<code class="descname">render</code><span class="sig-paren">(</span><em>theta=0</em>, <em>res=300</em>, <em>projection='ortho'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the map on a grid and return the pixel intensities (or
velocity-weighted intensities) as a
two-dimensional array (with time as an optional third dimension).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rv</strong> (<em>bool</em>) – Compute the intensity-weighted radial velocity field of                 the map? Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>, computes just the                 intensity map.</p></li>
<li><p><strong>theta</strong> (<em>float</em>) – Angle of rotation of the map in degrees. Default 0.</p></li>
<li><p><strong>res</strong> (<em>int</em>) – Map resolution, corresponding to the number of pixels                 on a side (for the orthographic projection) or the number of                 pixels in latitude (for the rectangular projection; the number                 of pixels in longitude is twice this value). Default 300.</p></li>
<li><p><strong>projection</strong> (<em>str</em>) – One of “orthographic” or “rectangular”. The former                 results in a map of the disk as seen on the plane of the sky,                 padded by <code class="xref py py-obj docutils literal notranslate"><span class="pre">NaN</span></code> outside of the disk. The latter results                 in an equirectangular (geographic, equidistant cylindrical)                 view of the entire surface of the map in latitude-longitude space.                 Default “orthographic”.</p></li>
<li><p><strong>t</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The time(s) at which to evaluate the map.                 <em>Temporal maps only</em>. Default 0.</p></li>
<li><p><strong>source</strong> (<em>ndarray</em>) – A unit vector corresponding to the direction to the                 light source. This may optionally be a vector of unit vectors.                 <em>Reflected light maps only</em>. Default <span class="math notranslate nohighlight">\(-\hat{x}\)</span>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">rv</span> <span class="pre">=</span> <span class="pre">True</span></code>, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">projection</span></code> kwarg is             ignored and the map can only be plotted in the orthographic projection.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all of the spherical harmonic, limb darkening, and filter
coefficients. Also reset the rotation axis.</p>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>theta=0</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the base map an angle <code class="xref py py-obj docutils literal notranslate"><span class="pre">theta</span></code> about <a class="reference internal" href="#starry.DopplerMap.axis" title="starry.DopplerMap.axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">axis</span></code></a>.
This performs a permanent rotation to the base map. Subsequent
rotations and calculations will be performed relative to this
rotational state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>float</em>) – Angle of rotation in degrees. Default 0.</p></li>
<li><p><strong>axis</strong> (<em>ndarray</em>) – Axis of rotation. Default is the current map axis.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method not available for purely limb-darkened maps.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.rv">
<code class="descname">rv</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.rv" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the net radial velocity one would measure from the object.</p>
<p>The radial velocity is computed as the ratio</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\Delta RV = \frac{\int Iv \mathrm{d}A}{\int I \mathrm{d}A}\)</span></p>
</div></blockquote>
<p>where both integrals are taken over the visible portion of the
projected disk. <span class="math notranslate nohighlight">\(I\)</span> is the intensity field (described by the
spherical harmonic and limb darkening coefficients) and <span class="math notranslate nohighlight">\(v\)</span>
is the radial velocity field (computed based on the equatorial velocity
of the star, its orientation, etc.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Time at which to evaluate. Default 0. <em>Temporal maps only.</em></p></li>
<li><p><strong>theta</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Angle of rotation. Default 0. <em>Not available for pure limb darkening.</em></p></li>
<li><p><strong>xo</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> position of the occultor (if any). Default 0. <em>Not available for pure limb darkening.</em></p></li>
<li><p><strong>yo</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <a class="reference internal" href="#starry.DopplerMap.y" title="starry.DopplerMap.y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code></a> position of the occultor (if any). Default 0. <em>Not available for pure limb darkening.</em></p></li>
<li><p><strong>zo</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">z</span></code> position of the occultor (if any). Default 1.0 (on the side closest to the observer).</p></li>
<li><p><strong>b</strong> (<em>float</em><em> or </em><em>ndarray</em>) – The impact parameter of the occultor. Default 0. <em>Purely limb-darkened maps only.</em></p></li>
<li><p><strong>ro</strong> (<em>float</em>) – The radius of the occultor in units of this body’s radius. Default 0 (no occultation).</p></li>
<li><p><strong>gradient</strong> (<em>bool</em>) – Compute and return the gradient of the flux as well? Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>source</strong> (<em>ndarray</em>) – The source position, a unit vector or a
vector of unit vectors. Default <span class="math notranslate nohighlight">\(-\hat{x} = (-1, 0, 0)\)</span>.
<em>Reflected light maps only.</em></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A vector of radial velocities. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">gradient</span></code> is enabled, also returns a dictionary whose keys are the derivatives of <cite>rv</cite> with respect to all model parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.rv_op">
<code class="descname">rv_op</code><span class="sig-paren">(</span><em>y=None</em>, <em>u=None</em>, <em>inc=None</em>, <em>obl=None</em>, <em>veq=None</em>, <em>alpha=None</em>, <em>theta=0</em>, <em>orbit=None</em>, <em>t=None</em>, <em>xo=None</em>, <em>yo=None</em>, <em>zo=1</em>, <em>ro=0.1</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.rv_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a
<a class="reference external" href="http://deeplearning.net/software/theano/extending/extending_theano.html">Theano Op</a>
for the RV computation.</p>
<p>This method is similar to <a class="reference internal" href="#starry.DopplerMap.rv" title="starry.DopplerMap.rv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rv()</span></code></a> but it does not return a
light curve / radial velocity curve! Instead, it returns a
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Theano</span></code> Op used for symbolic (lazy) gradient-based
computations useful for integration with <code class="xref py py-obj docutils literal notranslate"><span class="pre">exoplanet</span></code>
and <code class="xref py py-obj docutils literal notranslate"><span class="pre">pymc3</span></code>.</p>
<p>The arguments below can either be normal Python or <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code>
types, in which case they are assumed to be constant, or <code class="xref py py-obj docutils literal notranslate"><span class="pre">Theano</span></code>
tensor variables. They can also be set to <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code> (default), in
which case they take on the constant values set in the <a class="reference internal" href="#starry.Map" title="starry.Map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code></a>
object (or their default values, if they are not <a class="reference internal" href="#starry.Map" title="starry.Map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code></a>
attributes). As usual, the parameters <code class="xref py py-obj docutils literal notranslate"><span class="pre">theta</span></code>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">xo</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">yo</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">zo</span></code>, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">ro</span></code> may
be either scalars or vectors. Note that if an <code class="xref py py-obj docutils literal notranslate"><span class="pre">orbit</span></code> instance
is provided, <code class="xref py py-obj docutils literal notranslate"><span class="pre">xo</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">yo</span></code>, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">zo</span></code> are
ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> – The full vector of spherical harmonic coefficients,                 (skipping the <span class="math notranslate nohighlight">\(Y_{0,0}\)</span> term).</p></li>
<li><p><strong>u</strong> – The full vector of limb darkening coefficients,                  starting with <span class="math notranslate nohighlight">\(u_{1}\)</span>.</p></li>
<li><p><strong>inc</strong> – The map inclination in degrees.</p></li>
<li><p><strong>obl</strong> – The map obliquity in degrees.</p></li>
<li><p><strong>veq</strong> – The equatorial velocity (arbitrary units).</p></li>
<li><p><strong>alpha</strong> – The rotational shear coefficient.</p></li>
<li><p><strong>theta</strong> – The map rotation angle in degrees.</p></li>
<li><p><strong>orbit</strong> – An <code class="xref py py-obj docutils literal notranslate"><span class="pre">exoplanet</span></code> <code class="xref py py-obj docutils literal notranslate"><span class="pre">orbit</span></code> instance.</p></li>
<li><p><strong>t</strong> – The times at which to evaluate the <code class="xref py py-obj docutils literal notranslate"><span class="pre">orbit</span></code>.</p></li>
<li><p><strong>xo</strong> – The occultor x position.</p></li>
<li><p><strong>yo</strong> – The occultor y position.</p></li>
<li><p><strong>zo</strong> – The occultor z position.</p></li>
<li><p><strong>ro</strong> – The occultor radius.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-obj docutils literal notranslate"><span class="pre">Theano</span></code> Op defining the graph for the radial velocity computation.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="starry.DopplerMap.show">
<code class="descname">show</code><span class="sig-paren">(</span><em>Z=None</em>, <em>cmap='plasma'</em>, <em>projection='ortho'</em>, <em>grid=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.DopplerMap.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Render and plot an image of the map in either intensity or radial
velocity; optionally display an animation.</p>
<p>If running in a Jupyter Notebook, animations will be displayed
in the notebook using javascript.
Refer to the docstring of <a class="reference internal" href="#starry.DopplerMap.render" title="starry.DopplerMap.render"><code class="xref py py-meth docutils literal notranslate"><span class="pre">render()</span></code></a> for additional kwargs
accepted by this method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Z</strong> (<em>ndarray</em>) – The array of pixel intensities returned by a call                 to <a class="reference internal" href="#starry.DopplerMap.render" title="starry.DopplerMap.render"><code class="xref py py-meth docutils literal notranslate"><span class="pre">render()</span></code></a>. Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, in which case                 this routine will call <a class="reference internal" href="#starry.DopplerMap.render" title="starry.DopplerMap.render"><code class="xref py py-meth docutils literal notranslate"><span class="pre">render()</span></code></a> with any additional                 kwargs provided by the user.</p></li>
<li><p><strong>rv</strong> (<em>bool</em>) – Plot the intensity-weighted radial velocity field of                 the map? Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>, plots just the                 intensity map.</p></li>
<li><p><strong>cmap</strong> – The colormap used for plotting (a string or a                 <code class="xref py py-obj docutils literal notranslate"><span class="pre">matplotlib</span></code> colormap object). Default “plasma”.</p></li>
<li><p><strong>grid</strong> (<em>bool</em>) – Overplot static grid lines? Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>interval</strong> (<em>int</em>) – Interval in ms between frames (animated maps only).                 Default 75.</p></li>
<li><p><strong>mp4</strong> (<em>str</em>) – Name of the mp4 file to save the animation to                 (animated maps only). Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>kwargs</strong> – Any additional kwargs accepted by <a class="reference internal" href="#starry.DopplerMap.render" title="starry.DopplerMap.render"><code class="xref py py-meth docutils literal notranslate"><span class="pre">render()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">rv</span> <span class="pre">=</span> <span class="pre">True</span></code>, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">projection</span></code> kwarg is             ignored and the map can only be plotted in the orthographic projection.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.u">
<code class="descname">u</code><a class="headerlink" href="#starry.DopplerMap.u" title="Permalink to this definition">¶</a></dt>
<dd><p>The limb darkening map coefficients. For scalar maps,
this is a vector of the limb darkening coefficients
<span class="math notranslate nohighlight">\(\{u_1, u_2, u_3, ...\}\)</span>. For spectral maps, this is a <em>matrix</em>,
where each column is the limb darkening vector at a particular
wavelength. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.udeg">
<code class="descname">udeg</code><a class="headerlink" href="#starry.DopplerMap.udeg" title="Permalink to this definition">¶</a></dt>
<dd><p>The highest degree of the limb darkening filter. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.veq">
<code class="descname">veq</code><a class="headerlink" href="#starry.DopplerMap.veq" title="Permalink to this definition">¶</a></dt>
<dd><p>The equatorial velocity of the object in arbitrary units.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.y">
<code class="descname">y</code><a class="headerlink" href="#starry.DopplerMap.y" title="Permalink to this definition">¶</a></dt>
<dd><p>The spherical harmonic map coefficients. For scalar maps,
this is a vector of the coefficients of the spherical harmonics
<span class="math notranslate nohighlight">\(\{Y_{0,0}, Y_{1,-1}, Y_{1,0}, Y_{1,1}, ...\}\)</span>.
For spectral maps, this is a <em>matrix</em>, where each column
is the spherical harmonic vector at a particular wavelength.
For temporal maps, this is also a <em>flattened</em> matrix, where the
vectors corresponding to each temporal component are stacked
on top of each other. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.DopplerMap.ydeg">
<code class="descname">ydeg</code><a class="headerlink" href="#starry.DopplerMap.ydeg" title="Permalink to this definition">¶</a></dt>
<dd><p>The highest spherical harmonic degree of the map. <em>Read-only.</em></p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-starry.extensions">
<span id="the-extensions-module"></span><h2><a class="toc-backref" href="#id5">The extensions module</a><a class="headerlink" href="#module-starry.extensions" title="Permalink to this headline">¶</a></h2>
<p>This module provides custom extensions to <code class="xref py py-obj docutils literal notranslate"><span class="pre">starry</span></code>.</p>
<dl class="function">
<dt id="starry.extensions.MAP">
<code class="descclassname">starry.extensions.</code><code class="descname">MAP</code><span class="sig-paren">(</span><em>X</em>, <em>L</em>, <em>C</em>, <em>flux</em>, <em>return_cov=False</em>, <em>return_cho_W=False</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.extensions.MAP" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the maximum a posteriori (MAP) prediction for the
spherical harmonic coefficients of a map given a flux timeseries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – The design matrix returned by             <code class="xref py py-meth docutils literal notranslate"><span class="pre">Map.linear_flux_model()</span></code>, shape (ntime, nregressors).</p></li>
<li><p><strong>L</strong> – The prior covariance of the spherical harmonic coefficients.             This may be a scalar, a vector, a matrix, or the Cholesky             factorization of the covariance matrix (a tuple returned by             <code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.linalg.cho_factor</span></code>).</p></li>
<li><p><strong>C</strong> – The data covariance. This may be a scalar, a vector, a matrix,             or the Cholesky factorization of the covariance matrix (a tuple             returned by <code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.linalg.cho_factor</span></code>).</p></li>
<li><p><strong>flux</strong> (<em>ndarray</em>) – The flux timeseries.</p></li>
<li><p><strong>return_cov</strong> (<em>bool</em>) – Return the covariance matrix of the solution? Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>return_cho_W</strong> (<em>bool</em>) – Return the Cholesky factorization of the             quantity <span class="math notranslate nohighlight">\(W = X^T C^{-1} X + L^{-1}\)</span>? Default <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The vector of spherical harmonic coefficients corresponding to the
MAP solution, and optionally the covariance of the solution and the
Cholesky factorization of <span class="math notranslate nohighlight">\(W\)</span> (see above).</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="starry.extensions.log_likelihood">
<code class="descclassname">starry.extensions.</code><code class="descname">log_likelihood</code><span class="sig-paren">(</span><em>X</em>, <em>L</em>, <em>C</em>, <em>flux</em>, <em>yhat=None</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.extensions.log_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log likelihood of the linear model given
a flux timeseries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – The design matrix returned by             <code class="xref py py-meth docutils literal notranslate"><span class="pre">Map.linear_flux_model()</span></code>, shape (ntime, nregressors).</p></li>
<li><p><strong>L</strong> – The prior covariance of the spherical harmonic coefficients.             This may be a scalar, a vector, a matrix, or the Cholesky             factorization of the covariance matrix (a tuple returned by             <code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.linalg.cho_factor</span></code>).</p></li>
<li><p><strong>C</strong> – The data covariance. This may be a scalar, a vector, a matrix,             or the Cholesky factorization of the covariance matrix (a tuple             returned by <code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.linalg.cho_factor</span></code>).</p></li>
<li><p><strong>flux</strong> (<em>ndarray</em>) – The flux timeseries.</p></li>
<li><p><strong>yhat</strong> (<em>ndarray</em>) – If not <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, computes the log likelihood             of the model specified by the spherical harmonic vector <code class="xref py py-obj docutils literal notranslate"><span class="pre">yhat</span></code>. If             <code class="xref py py-obj docutils literal notranslate"><span class="pre">yhat</span></code> is not provided, instead computes the <em>marginal             log likelihood</em> of the model, marginalizing over all values             of <code class="xref py py-obj docutils literal notranslate"><span class="pre">yhat</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The log likelihood (optionally the marginal log likelihood), a scalar.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="starry.extensions.RAxisAngle">
<code class="descclassname">starry.extensions.</code><code class="descname">RAxisAngle</code><span class="sig-paren">(</span><em>axis</em>, <em>angle</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.extensions.RAxisAngle" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the 3x3 Cartesian rotation matrix for rotation
through an angle <code class="xref py py-obj docutils literal notranslate"><span class="pre">theta</span></code> about the unit vector <code class="xref py py-obj docutils literal notranslate"><span class="pre">axis</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>ndarray</em>) – A Cartesian unit vector.</p></li>
<li><p><strong>angle</strong> (<em>scalar</em>) – The angle of rotation in degrees.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="notebooks/LDNormalization.html" class="btn btn-neutral" title="Notes on limb darkening normalization" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Rodrigo Luger.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.0.dev1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="None"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>